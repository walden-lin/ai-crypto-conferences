<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Loading Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: white;
            padding: 20px;
        }
        .test-result {
            background: #2a2a2a;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #00ff00;
        }
        .error {
            border-left-color: #ff0000;
        }
    </style>
</head>
<body>
    <h1>🔍 Data Loading Test</h1>
    <div id="results"></div>

    <script>
        async function testDataLoading() {
            const results = document.getElementById('results');
            
            try {
                results.innerHTML = '<div class="test-result">🔄 Testing data loading...</div>';
                
                const response = await fetch('data/events.json');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const events = await response.json();
                
                // Calculate this week's events
                const now = new Date();
                const startOfWeek = new Date(now);
                const dayOfWeek = now.getDay();
                const daysToMonday = dayOfWeek === 0 ? -6 : 1 - dayOfWeek;
                startOfWeek.setDate(now.getDate() + daysToMonday);
                startOfWeek.setHours(0, 0, 0, 0);
                
                const endOfWeek = new Date(startOfWeek);
                endOfWeek.setDate(startOfWeek.getDate() + 6);
                endOfWeek.setHours(23, 59, 59, 999);
                
                const thisWeekEvents = events.filter(event => {
                    const eventDate = new Date(event.startDate);
                    return eventDate >= startOfWeek && eventDate <= endOfWeek;
                });
                
                results.innerHTML = `
                    <div class="test-result">
                        ✅ <strong>SUCCESS!</strong> Data loaded successfully<br>
                        📊 Total events: ${events.length.toLocaleString()}<br>
                        📅 Date range: ${events[0]?.startDate} to ${events[events.length-1]?.startDate}<br>
                        📅 This week events: ${thisWeekEvents.length}<br>
                        🏙️ Sample locations: ${[...new Set(events.slice(0, 10).map(e => e.location))].join(', ')}<br>
                        🏷️ Categories: ${[...new Set(events.map(e => e.category))].join(', ')}
                    </div>
                    <div class="test-result">
                        <strong>This Week's Events:</strong><br>
                        ${thisWeekEvents.slice(0, 5).map(e => `• ${e.title} (${e.startDate}) - ${e.location}`).join('<br>')}
                        ${thisWeekEvents.length === 0 ? 'No events this week' : ''}
                    </div>
                    <div class="test-result">
                        <strong>Sample Events:</strong><br>
                        ${events.slice(0, 5).map(e => `• ${e.title} (${e.startDate}) - ${e.location}`).join('<br>')}
                    </div>
                    <div class="test-result">
                        <a href="index.html" style="color: #00ff00; text-decoration: none; font-weight: bold;">
                            🚀 Go to Main Website (with This Week filter!)
                        </a>
                    </div>
                `;
                
            } catch (error) {
                results.innerHTML = `
                    <div class="test-result error">
                        ❌ <strong>ERROR:</strong> ${error.message}<br>
                        Please check that data/events.json exists and the server is running.
                    </div>
                `;
            }
        }
        
        testDataLoading();
    </script>
</body>
</html>
